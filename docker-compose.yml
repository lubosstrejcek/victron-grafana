services:
  grafana:
    image: grafana/grafana:latest
    container_name: victron-grafana
    restart: unless-stopped
    ports:
      - "${GRAFANA_PORT:-3000}:3000"
    volumes:
      - ./data:/var/lib/grafana
      - ./provisioning:/etc/grafana/provisioning
    environment:
      - TZ=${TZ:-Europe/Prague}
      - GF_SECURITY_ADMIN_USER=${GRAFANA_USER:-admin}
      - GF_SECURITY_ADMIN_PASSWORD=${GRAFANA_PASSWORD:-victron123}
      - GF_AUTH_ANONYMOUS_ENABLED=${GRAFANA_ANON_ENABLED:-true}
      - GF_AUTH_ANONYMOUS_ORG_ROLE=${GRAFANA_ANON_ROLE:-Viewer}
      - GF_PANELS_DISABLE_SANITIZE_HTML=true
      # InfluxDB connection for provisioning
      - INFLUXDB_URL=${INFLUXDB_URL:-http://influxdb:8086}
      - INFLUXDB_TOKEN=${INFLUXDB_TOKEN:-victron-lab-token}
      - INFLUXDB_ORG=${INFLUXDB_ORG:-victron}
      - INFLUXDB_BUCKET=${INFLUXDB_BUCKET:-energy}
